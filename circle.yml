#
# build configuration for circle CI
#

general:
    artifacts:
       - /home/ubuntu/AndroidCircleCI/app/build/outputs/apk/
       - /home/ubuntu/AndroidCircleCI/app/build/reports/tests/testDebugUnitTest/


    branches:
       only:
          - development
          - /release\/.*/


machine:
    environment:
       ANDROID_HOME: /usr/local/android-sdk-linux


dependencies:
    cache_directories:
      - /usr/local/android-sdk-linux/build-tools/25.0.2
      - /usr/local/android-sdk-linux/platforms/android-25
      - /usr/local/android-sdk-linux/extras/android/m2repository

    override:
      - if [ ! -e /usr/local/android-sdk-linux/build-tools/25.0.2 ]; then echo y | android update sdk --all --no-ui --filter "build-tools-25.0.2"; fi;
      - if [ ! -e /usr/local/android-sdk-linux/platforms/android-25 ]; then echo y | android update sdk --all --no-ui --filter "android-25"; fi;
      - if [ ! -e /usr/local/android-sdk-linux/extras/android/m2repository ]; then echo y | android update sdk --all --no-ui --filter "extra-android-m2repository"; fi;

#       - echo y | android update sdk --no-ui --all --filter tools,platform-tools,build-tools-25.0.2,extra-google-m2repository,extra-google-google-play-services,extra-android-support
#       - ANDROID_HOME=/usr/local/android-sdk-linux ./gradlew dependencies


test:
    override:
      - ./gradlew test

deployment:
    development:
       branch: development
       commands:
         - ./gradlew assembleDebug crashlyticsUploadDistributionDebug

    release:
       branch: /release\/.*/
       commands:
         #Add deployments Commands for release branches here.

